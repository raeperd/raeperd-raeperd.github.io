<!doctype html><html lang=korean dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>The Network Layer | raeperd.github.io</title>
<meta name=keywords content="network">
<meta name=description content="CIDR (Classless Inter-Domain Routing) Address class를 이용해 IP 주소를 잘 나눌 수 있었다. Subnetting은 Address class로 나누어진 network 를 기존의 규칙을 유지하면서 네트워크를 더 작게 분할할 수 있게 해줬다. 그런데 인터넷이 더 커지면서 Subnetting 도 충분하지 않게 되었다.
254 개의 호스트를 사용할 수 있는 class C 네트워크 보다는 많고 65534 개의 호스트를 사용할 수 있는 class B 네트워크는 너무 많다고 느껴지면 어떻게 할까? class C 네트워크 여러 개를 사용하는 방법이 있다.">
<meta name=author content="raeperd">
<link rel=canonical href=https://raeperd.github.io/notes/network/the-network-layer/>
<link href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style>
<link rel=icon href=https://raeperd.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://raeperd.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://raeperd.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://raeperd.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://raeperd.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.86.1">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-168674186-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<meta property="og:title" content="The Network Layer">
<meta property="og:description" content="CIDR (Classless Inter-Domain Routing) Address class를 이용해 IP 주소를 잘 나눌 수 있었다. Subnetting은 Address class로 나누어진 network 를 기존의 규칙을 유지하면서 네트워크를 더 작게 분할할 수 있게 해줬다. 그런데 인터넷이 더 커지면서 Subnetting 도 충분하지 않게 되었다.
254 개의 호스트를 사용할 수 있는 class C 네트워크 보다는 많고 65534 개의 호스트를 사용할 수 있는 class B 네트워크는 너무 많다고 느껴지면 어떻게 할까? class C 네트워크 여러 개를 사용하는 방법이 있다.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://raeperd.github.io/notes/network/the-network-layer/"><meta property="og:image" content="https://raeperd.github.io/papermod-cover.png"><meta property="article:section" content="notes">
<meta property="article:published_time" content="2020-05-19T00:00:00+00:00">
<meta property="article:modified_time" content="2020-05-19T00:00:00+00:00"><meta property="og:site_name" content="raeperd.github.io">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://raeperd.github.io/papermod-cover.png">
<meta name=twitter:title content="The Network Layer">
<meta name=twitter:description content="CIDR (Classless Inter-Domain Routing) Address class를 이용해 IP 주소를 잘 나눌 수 있었다. Subnetting은 Address class로 나누어진 network 를 기존의 규칙을 유지하면서 네트워크를 더 작게 분할할 수 있게 해줬다. 그런데 인터넷이 더 커지면서 Subnetting 도 충분하지 않게 되었다.
254 개의 호스트를 사용할 수 있는 class C 네트워크 보다는 많고 65534 개의 호스트를 사용할 수 있는 class B 네트워크는 너무 많다고 느껴지면 어떻게 할까? class C 네트워크 여러 개를 사용하는 방법이 있다.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://raeperd.github.io/notes/"},{"@type":"ListItem","position":2,"name":"The Network Layer","item":"https://raeperd.github.io/notes/network/the-network-layer/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"The Network Layer","name":"The Network Layer","description":"CIDR (Classless Inter-Domain Routing) Address class를 이용해 IP 주소를 잘 나눌 수 있었다. Subnetting은 Address class로 나누어진 network 를 기존의 규칙을 유지하면서 네트워크를 더 작게 분할할 수 있게 해줬다. 그런데 인터넷이 더 커지면서 Subnetting 도 충분하지 않게 되었다.\n254 개의 호스트를 사용할 수 있는 class C 네트워크 보다는 많고 65534 개의 호스트를 사용할 수 있는 class B 네트워크는 너무 많다고 느껴지면 어떻게 할까? class C 네트워크 여러 개를 사용하는 방법이 있다.","keywords":["network"],"articleBody":"CIDR (Classless Inter-Domain Routing) Address class를 이용해 IP 주소를 잘 나눌 수 있었다. Subnetting은 Address class로 나누어진 network 를 기존의 규칙을 유지하면서 네트워크를 더 작게 분할할 수 있게 해줬다. 그런데 인터넷이 더 커지면서 Subnetting 도 충분하지 않게 되었다.\n254 개의 호스트를 사용할 수 있는 class C 네트워크 보다는 많고 65534 개의 호스트를 사용할 수 있는 class B 네트워크는 너무 많다고 느껴지면 어떻게 할까? class C 네트워크 여러 개를 사용하는 방법이 있다. 이런 현상이 반복되면, 라우팅 테이블의 class C 여러 네트워크들은 다른 주소를 가지고 있지만 실제로는 같은 장소로 라우팅 될 것 이다. CIDR 가 이를 해결해 줄 수있다.\ndemarcation point  To describe where one network or system ends and another one begins  CIDR 에서는 네트워크 아이디와 subnet ID는 하나로 통합된다. CIDR는 기존의 address class 의 규칙을 무시한 새로운 규칙이다. 단순히 address class 를 무시했기 때문에, subnet mask로 사용되는 만큼 network ID를 부여할 수있고, 그만큼 호스트 아이디를 가질 수 있다. 규칙이 간단해서 이해하고 적용하기도 쉬운반면 기존의 address class 보다 효율적인 면도 있다. ￼ 클래스 C를 두개 쓰면 508개의 호스트를 가질 수 있지만 /23 network 는 클래스 C보다 단지 하나의 비트를 호스트에 더 할당함으로써 510개의 호스트를 가질 수 있다.\nRouting Basic Routing concept Router 네트워크 트래픽을 목적지로 전달시키는 네트워크 장비 라우터는 최소한 두개의 네트워크 인터페이스와 연결되어 있어야 한다. 그래야 연결해 줄 수 있으니까. 라우터는 기본적으로 4 단계의 동작을 한다. ￼\n 연결된 네트워크 인터페이스들 중 하나로부터 패킷을 받는다. 패킷의 도착 IP 주소를 확인한다. 라우팅 테이블에서 IP 주소를 확인한다. 트래픽을 도착지로 전달한다.  IP 주소는 네트워크에 속해있다. IP 주소 하나 하나가 하나의 네트워크를 의미하는 것이 아니다. 192.168.1.100 주소의 컴퓨터에서 10.0.0.10 의 주소로 패킷을 보낸다. 이때 컴퓨터 A는 자신이 속한 네트워크에 10.0.0.10 의 주소가 없다는 것을 알 수 있고, 이 패킷을 gateway router 에게 전달하는데 이 때의 전송은 gateway의 MAC 주소를 통해 한다.\n그렇게 라우터는 Data link layer 의 패킷을 받게 되는데, 한번 받은 이후에는 Data-link layer의 정보를 잘라낸다. (Ethernet header와 Ethernet footer) IP datagram 에는 10.0.0.10의 주소가 기록되어있는데 라우터는 routing table에서 Network B가 올바른 목적지라는 것을 알 수 있다. 실제로 라우터워 Network B는 직접 연결되어 있기 때문에 router는 10.0.0.10의 MAC 주소까지 ARP 테이블에 가지고 있다.\n이제 라우터는 IP datagram의 모든 데이터를 복사하고, TTL 필드의 값을 하나 낮추며, 다시 체크섬을 계산한다. 이를 새로운 Ethernet frame 으로 만드는데, 이번에 Ethernet frame의 Source MAC address 는 라우터 자신의 주소가 되고, destination MAC address는 도착지의 MAC 주소가 된다.\n이정도가 기본적인 라우팅 과정인데, 좀 더 복잡한 경우는 어떻게 될까?\n더 복잡한 경우 이번에는 192.168.1.100 에서 172.16.1.100 으로 패킷을 전달하려고 한다고 해보자. 앞의 과정과 같이 Network B 까지 같은 과정으로 패킷이 전달 됬을 것이다. 그러나 Router A는 이전과 달리 172.16.1.100 의 주소를 Network B에서 찾지 못한다. 다른 라우터를 통해야 한다는 것을 알게된 Router A는 Router B의 IP 주소로 같은 패킷을 전달한다. 마찬가지로 TTL을 감소시키고 다시 체크섬을 계산하는 과정을 거친다. Router B에 도착한 패킷은 앞에서와 같은 원리로 도착지에 전달될 수 있다.\n실제로는 라우터에 더 많은 네트워크가 연결되어 있을 수 있고, 하나의 패킷이 전달되는 경로는 유일하지 않을 수 있다. 라우터가 어떻게 효율적으로 패킷의 경로를 알 수 있는지는 또 다른 복잡한 알고리즘들이 필요하겠지만 핵심은 같다.\nRouting tables 최신의 운영체제들은 대부분 라우팅 테이블을 가지고 있다. 그래서 컴퓨터와 수동으로 업데이트 되는 라우팅 테이블만 있다면 라우터를 만들어볼 수도 있다. 라우터를 어떻게 만드느냐에 따라 종류는 많지만 몇가지 공통되는 특징을 가지고 있다. 보통의 라우팅 테이블은 4개의 컬럼을 가진다.\n Destination network  여러 컬럼에 나눠 저장될수도 있고, 하나의 컬럼에 저장될 수도 있으나 본질은 같음 catchall entry라는 것을 가지고 있는데 ARP 테이블에 없는 destination address의 패킷을 전달하는 곳   Next hop  도착지를 묻는데 사용될 수 있는 다음 라우터 목적지까지 가기위한 바로 다음의 라우터 또는 경로   Total hops  출발지와 도착지 사이의 네트워크 장치의 수   Interface  라우터가 대상 네트워크와 트래픽을 일치시키기 위해 어떤 인터페이스를 사용해야하는지 알아야 한다. ￼ 라우터는 최적의 경로로 데이터를 전달하고자 하겠지만, 사실 이게 쉬운일은 아니다. 최적의 경로를 찾는다 한들 이는 변할 수 있다. 새로운 라우터가 추가되거나, 없어질 수도 있으니까. 트래픽이 몰려서 정체현상 같은게 일어날수도 있고. 라우터는 위의 정보들과 이웃 라우터들로 부터 새로운 정보를 전달받으면서 더 나은 경로를 찾으려고 한다.    Routing Protocol 간단한 라우팅 원리를 알아봤는데 라우팅의 진짜 마법은 라우터가 어떻게 도착지 경로를 알고, 다음 경로를 계산하는지이다. 라우터들은 이를 위해, 서로의 정보를 공유하는데 이때 사용되는 프로토콜이 Routing Protocol 이다.\nInterior gateway protocol  하나의 Autonomous system 내부에서 사용되는 프로토콜 Autonomous system 은 하나의 network operator에 의해 제어되는 네트워크들의 모임  Internet service provider나 큰 규모의 회사들 ￼   Distance-vector protocol  total hops 와 함께 자신의 이웃 라우터들에게 라우팅 테이블을 공유 내가 아는 total hops 보다 니가 아는거 + 1 이 더 적구나? 그럼 너한테 보내면 되겠네? 많은 정보를 알고 있는건 아니라 네트워크의 변화에 적응하는데 시간이 걸릴것  RIP (Routing Internet Protocol) 같은 것이 대표적 ￼   Link state routing protocol  라우터의 상태를 모두 서로 공유하고 있는상태 Distance vector protocol 보다 더 많은 정보를 가지고 있고 네트워크의 변화에 유연하다. 더 많은 메모리와 컴퓨팅 파워가 필요하지만 최근의 기술로 이게 더 많이 쓰이게 됬다.  OSPF(Open Shortest Path First) 같은 것이 대표적    Exterior gateway protocol  Exterior gateway protocols are used to communicate data between routers representing the edges of an autonomous system. 이게 중요한 역할을 한다. 하나의 프로토콜 만이 존재하는데, 이런 종류의 데이터 통신에는 어느정도의 합의가 필요했던 것 같다. BGP (Broader Gateway Protocol) 라고 한다.  IANA (Internet Assigned Numbers Authority)  IP 할당과 같은 것을 관리하는 것을 도와주는 비영리 단체 이런 단체가 없으면 본인들 마음대로 IP를 쓰게될텐데 길찾기가 영 쉽지 않을 것이다. IP 할당뿐만 아니라 ASN(Autonomous System Number)의 할당도 관리한다.  IP 주소처럼 32bit로, 하나의 Autunomous System에 할당되는 고유한 숫자다. IP 처럼 나뉜 숫자가 아니라 한번에 쓰이는데 IP 처럼 보통 사람의 눈에 많이 띌 숫자가 아니기 때문 Exterior gateway protocol을 이해해야만 해결할 수 있는 이슈는 많지 않을 것이다. Internet service provider 같은 곳에서 일하게된다면 많이 쓰이겠지만 일반적인 개발자는 그냥 그런게 있지~ 하고 받아들이고 사용하면 될 것 같다.    Non-Routable Address Space 과거에서부터 인터넷이 더 발전하면 32 bit IP 주소는 부족할 것으로 예상됐다. 1996년에 RFC 1918이 설립되었고 이곳에서 세상의 인터넷이 잘 동작하도록 여러가지 규칙들을 만드는 기능을 한다. Non-Routable Address Space는 말그대로 라우팅이 불가능한 주소이다. 모든 네트워크 장비가 세상의 모든 네트워크 장비와 송수신이 가능할 필요는 없기 때문에 이런 주소가 필요하게 됬다. NAT라는 기술을 통해 외부와 통신할 수 있지만 나중에 배워보도록 하자. 일단 이 주소들은 통신이 불가능하다고 생각하자. 어차피 외부와 소통할 수 없는 주소이기 때문에 어떤 사람이든지 사용할 수 있는 주소다. 크게 3가지 주소가 있다.\n 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 누구나 개인 혹은 내부망으로 이런 주소들을 사용할 수 있다. 내부 게이트웨이 프로토콜은 이러한 주소 공간을 라우팅 할 수 있지만 exterior gateway protocol 들은 라우팅 할 수없다. ￼  Referenced  computer-networking\n","wordCount":"1028","inLanguage":"korean","datePublished":"2020-05-19T00:00:00Z","dateModified":"2020-05-19T00:00:00Z","author":{"@type":"Person","name":"raeperd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://raeperd.github.io/notes/network/the-network-layer/"},"publisher":{"@type":"Organization","name":"raeperd.github.io","logo":{"@type":"ImageObject","url":"https://raeperd.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<noscript>
<style type=text/css>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://raeperd.github.io/ accesskey=h title="raeperd.github.io (Alt + H)">raeperd.github.io</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu onscroll=menu_on_scroll()>
<li>
<a href=https://raeperd.github.io/articles title=Article>
<span>Article</span>
</a>
</li>
<li>
<a href=https://raeperd.github.io/notes title=Note>
<span>Note</span>
</a>
</li>
<li>
<a href=https://raeperd.github.io/search title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://raeperd.github.io/archives/ title=Archives>
<span>Archives</span>
</a>
</li></ul>
</nav>
</header>
<main class=main><article class=post-single>
<header class=post-header>
<h1 class=post-title>
The Network Layer
</h1>
<div class=post-meta>
May 19, 2020&nbsp;·&nbsp;raeperd
</div>
<br>
<ul class=post-tags>
<li><a href=https://raeperd.github.io/tags/network/>network</a></li>
</ul>
</header>
<div class=post-content>
<h1 id=cidr-classless-inter-domain-routing>CIDR (Classless Inter-Domain Routing)<a hidden class=anchor aria-hidden=true href=#cidr-classless-inter-domain-routing>#</a></h1>
<p>Address class를 이용해 IP 주소를 잘 나눌 수 있었다. Subnetting은 Address class로 나누어진 network 를 기존의 규칙을 유지하면서 네트워크를 더 작게 분할할 수 있게 해줬다. 그런데 인터넷이 더 커지면서 Subnetting 도 충분하지 않게 되었다.</p>
<p>254 개의 호스트를 사용할 수 있는 class C 네트워크 보다는 많고 65534 개의 호스트를 사용할 수 있는 class B 네트워크는 너무 많다고 느껴지면 어떻게 할까? class C 네트워크 여러 개를 사용하는 방법이 있다. 이런 현상이 반복되면, 라우팅 테이블의 class C 여러 네트워크들은 다른 주소를 가지고 있지만 실제로는 같은 장소로 라우팅 될 것 이다.
CIDR 가 이를 해결해 줄 수있다.</p>
<h2 id=demarcation-point>demarcation point<a hidden class=anchor aria-hidden=true href=#demarcation-point>#</a></h2>
<ul>
<li>To describe where one network or system ends and another one begins</li>
</ul>
<p>CIDR 에서는 네트워크 아이디와 subnet ID는 하나로 통합된다. CIDR는 기존의 address class 의 규칙을 무시한 새로운 규칙이다. 단순히 address class 를 무시했기 때문에, subnet mask로 사용되는 만큼 network ID를 부여할 수있고, 그만큼 호스트 아이디를 가질 수 있다. 규칙이 간단해서 이해하고 적용하기도 쉬운반면 기존의 address class 보다 효율적인 면도 있다.
￼
클래스 C를 두개 쓰면 508개의 호스트를 가질 수 있지만 /23 network 는 클래스 C보다 단지 하나의 비트를 호스트에 더 할당함으로써 510개의 호스트를 가질 수 있다.</p>
<h1 id=routing>Routing<a hidden class=anchor aria-hidden=true href=#routing>#</a></h1>
<h3 id=basic-routing-concept>Basic Routing concept<a hidden class=anchor aria-hidden=true href=#basic-routing-concept>#</a></h3>
<h3 id=router>Router<a hidden class=anchor aria-hidden=true href=#router>#</a></h3>
<p>네트워크 트래픽을 목적지로 전달시키는 네트워크 장비
라우터는 최소한 두개의 네트워크 인터페이스와 연결되어 있어야 한다. 그래야 연결해 줄 수 있으니까. 라우터는 기본적으로 4 단계의 동작을 한다.
￼</p>
<ol>
<li>연결된 네트워크 인터페이스들 중 하나로부터 패킷을 받는다.</li>
<li>패킷의 도착 IP 주소를 확인한다.</li>
<li>라우팅 테이블에서 IP 주소를 확인한다.</li>
<li>트래픽을 도착지로 전달한다.</li>
</ol>
<p>IP 주소는 네트워크에 속해있다. IP 주소 하나 하나가 하나의 네트워크를 의미하는 것이 아니다.
192.168.1.100 주소의 컴퓨터에서 10.0.0.10 의 주소로 패킷을 보낸다. 이때 컴퓨터 A는 자신이 속한 네트워크에 10.0.0.10 의 주소가 없다는 것을 알 수 있고, 이 패킷을 gateway router 에게 전달하는데 이 때의 전송은 gateway의 MAC 주소를 통해 한다.</p>
<p>그렇게 라우터는 Data link layer 의 패킷을 받게 되는데, 한번 받은 이후에는 Data-link layer의 정보를 잘라낸다.
(Ethernet header와 Ethernet footer) IP datagram 에는 10.0.0.10의 주소가 기록되어있는데 라우터는 routing table에서 Network B가 올바른 목적지라는 것을 알 수 있다. 실제로 라우터워 Network B는 직접 연결되어 있기 때문에 router는 10.0.0.10의 MAC 주소까지 ARP 테이블에 가지고 있다.</p>
<p>이제 라우터는 IP datagram의 모든 데이터를 복사하고, TTL 필드의 값을 하나 낮추며, 다시 체크섬을 계산한다. 이를 새로운 Ethernet frame 으로 만드는데, 이번에 Ethernet frame의 Source MAC address 는 라우터 자신의 주소가 되고, destination MAC address는 도착지의 MAC 주소가 된다.</p>
<p>이정도가 기본적인 라우팅 과정인데, 좀 더 복잡한 경우는 어떻게 될까?</p>
<h3 id=더-복잡한-경우>더 복잡한 경우<a hidden class=anchor aria-hidden=true href=#더-복잡한-경우>#</a></h3>
<p>이번에는 192.168.1.100 에서 172.16.1.100 으로 패킷을 전달하려고 한다고 해보자. 앞의 과정과 같이 Network B 까지 같은 과정으로 패킷이 전달 됬을 것이다. 그러나 Router A는 이전과 달리 172.16.1.100 의 주소를 Network B에서 찾지 못한다. 다른 라우터를 통해야 한다는 것을 알게된 Router A는 Router B의 IP 주소로 같은 패킷을 전달한다. 마찬가지로 TTL을 감소시키고 다시 체크섬을 계산하는 과정을 거친다. Router B에 도착한 패킷은 앞에서와 같은 원리로 도착지에 전달될 수 있다.</p>
<p>실제로는 라우터에 더 많은 네트워크가 연결되어 있을 수 있고, 하나의 패킷이 전달되는 경로는 유일하지 않을 수 있다. 라우터가 어떻게 효율적으로 패킷의 경로를 알 수 있는지는 또 다른 복잡한 알고리즘들이 필요하겠지만 핵심은 같다.</p>
<h3 id=routing-tables>Routing tables<a hidden class=anchor aria-hidden=true href=#routing-tables>#</a></h3>
<p>최신의 운영체제들은 대부분 라우팅 테이블을 가지고 있다. 그래서 컴퓨터와 수동으로 업데이트 되는 라우팅 테이블만 있다면 라우터를 만들어볼 수도 있다. 라우터를 어떻게 만드느냐에 따라 종류는 많지만 몇가지 공통되는 특징을 가지고 있다.
보통의 라우팅 테이블은 4개의 컬럼을 가진다.</p>
<ol>
<li>Destination network
<ul>
<li>여러 컬럼에 나눠 저장될수도 있고, 하나의 컬럼에 저장될 수도 있으나 본질은 같음</li>
<li>catchall entry라는 것을 가지고 있는데 ARP 테이블에 없는 destination address의 패킷을 전달하는 곳</li>
</ul>
</li>
<li>Next hop
<ul>
<li>도착지를 묻는데 사용될 수 있는 다음 라우터</li>
<li>목적지까지 가기위한 바로 다음의 라우터 또는 경로</li>
</ul>
</li>
<li>Total hops
<ul>
<li>출발지와 도착지 사이의 네트워크 장치의 수</li>
</ul>
</li>
<li>Interface
<ul>
<li>라우터가 대상 네트워크와 트래픽을 일치시키기 위해 어떤 인터페이스를 사용해야하는지 알아야 한다.
￼
라우터는 최적의 경로로 데이터를 전달하고자 하겠지만, 사실 이게 쉬운일은 아니다. 최적의 경로를 찾는다 한들 이는 변할 수 있다. 새로운 라우터가 추가되거나, 없어질 수도 있으니까. 트래픽이 몰려서 정체현상 같은게 일어날수도 있고.
라우터는 위의 정보들과 이웃 라우터들로 부터 새로운 정보를 전달받으면서 더 나은 경로를 찾으려고 한다.</li>
</ul>
</li>
</ol>
<h3 id=routing-protocol>Routing Protocol<a hidden class=anchor aria-hidden=true href=#routing-protocol>#</a></h3>
<p>간단한 라우팅 원리를 알아봤는데 라우팅의 진짜 마법은 라우터가 어떻게 도착지 경로를 알고, 다음 경로를 계산하는지이다. 라우터들은 이를 위해, 서로의 정보를 공유하는데 이때 사용되는 프로토콜이 Routing Protocol 이다.</p>
<h3 id=interior-gateway-protocol>Interior gateway protocol<a hidden class=anchor aria-hidden=true href=#interior-gateway-protocol>#</a></h3>
<ul>
<li>하나의 Autonomous system 내부에서 사용되는 프로토콜</li>
<li>Autonomous system 은 하나의 network operator에 의해 제어되는 네트워크들의 모임
<ul>
<li>Internet service provider나 큰 규모의 회사들
￼</li>
</ul>
</li>
<li>Distance-vector protocol
<ul>
<li>total hops 와 함께 자신의 이웃 라우터들에게 라우팅 테이블을 공유</li>
<li>내가 아는 total hops 보다 니가 아는거 + 1 이 더 적구나?</li>
<li>그럼 너한테 보내면 되겠네?</li>
<li>많은 정보를 알고 있는건 아니라 네트워크의 변화에 적응하는데 시간이 걸릴것</li>
<li>
<a href=https://en.wikipedia.org/wiki/Routing_Information_Protocol target=_blank>RIP (Routing Internet Protocol)</a> 같은 것이 대표적
￼</li>
</ul>
</li>
<li>Link state routing protocol
<ul>
<li>라우터의 상태를 모두 서로 공유하고 있는상태</li>
<li>Distance vector protocol 보다 더 많은 정보를 가지고 있고 네트워크의 변화에 유연하다.</li>
<li>더 많은 메모리와 컴퓨팅 파워가 필요하지만 최근의 기술로 이게 더 많이 쓰이게 됬다.</li>
<li>
<a href=https://en.wikipedia.org/wiki/Open_Shortest_Path_First target=_blank>OSPF(Open Shortest Path First)</a> 같은 것이 대표적</li>
</ul>
</li>
</ul>
<h3 id=exterior-gateway-protocol>Exterior gateway protocol<a hidden class=anchor aria-hidden=true href=#exterior-gateway-protocol>#</a></h3>
<ul>
<li>Exterior gateway protocols are used to communicate data between routers representing the edges of an autonomous system.</li>
<li>이게 중요한 역할을 한다.</li>
<li>하나의 프로토콜 만이 존재하는데, 이런 종류의 데이터 통신에는 어느정도의 합의가 필요했던 것 같다.
<a href=https://en.wikipedia.org/wiki/Border_Gateway_Protocol target=_blank>BGP (Broader Gateway Protocol)</a> 라고 한다.</li>
</ul>
<h3 id=iana-internet-assigned-numbers-authority>IANA (Internet Assigned Numbers Authority)<a hidden class=anchor aria-hidden=true href=#iana-internet-assigned-numbers-authority>#</a></h3>
<ul>
<li>IP 할당과 같은 것을 관리하는 것을 도와주는 비영리 단체</li>
<li>이런 단체가 없으면 본인들 마음대로 IP를 쓰게될텐데 길찾기가 영 쉽지 않을 것이다.</li>
<li>IP 할당뿐만 아니라 ASN(Autonomous System Number)의 할당도 관리한다.
<ul>
<li>IP 주소처럼 32bit로, 하나의 Autunomous System에 할당되는 고유한 숫자다.</li>
<li>IP 처럼 나뉜 숫자가 아니라 한번에 쓰이는데 IP 처럼 보통 사람의 눈에 많이 띌 숫자가 아니기 때문
Exterior gateway protocol을 이해해야만 해결할 수 있는 이슈는 많지 않을 것이다. Internet service provider 같은 곳에서 일하게된다면 많이 쓰이겠지만 일반적인 개발자는 그냥 그런게 있지~ 하고 받아들이고 사용하면 될 것 같다.</li>
</ul>
</li>
</ul>
<h3 id=non-routable-address-space>Non-Routable Address Space<a hidden class=anchor aria-hidden=true href=#non-routable-address-space>#</a></h3>
<p>과거에서부터 인터넷이 더 발전하면 32 bit IP 주소는 부족할 것으로 예상됐다. 1996년에 RFC 1918이 설립되었고 이곳에서 세상의 인터넷이 잘 동작하도록 여러가지 규칙들을 만드는 기능을 한다.
Non-Routable Address Space는 말그대로 라우팅이 불가능한 주소이다. 모든 네트워크 장비가 세상의 모든 네트워크 장비와 송수신이 가능할 필요는 없기 때문에 이런 주소가 필요하게 됬다. NAT라는 기술을 통해 외부와 통신할 수 있지만 나중에 배워보도록 하자. 일단 이 주소들은 통신이 불가능하다고 생각하자.
어차피 외부와 소통할 수 없는 주소이기 때문에 어떤 사람이든지 사용할 수 있는 주소다. 크게 3가지 주소가 있다.</p>
<ul>
<li>10.0.0.0/8</li>
<li>172.16.0.0/12</li>
<li>192.168.0.0/16
누구나 개인 혹은 내부망으로 이런 주소들을 사용할 수 있다. 내부 게이트웨이 프로토콜은 이러한 주소 공간을 라우팅 할 수 있지만 exterior gateway protocol 들은 라우팅 할 수없다.
￼</li>
</ul>
<h1 id=referenced>Referenced<a hidden class=anchor aria-hidden=true href=#referenced>#</a></h1>
<p>
<a href=https://www.coursera.org/learn/computer-networking target=_blank>computer-networking</a></p>
</div>
<footer class=post-footer>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share The Network Layer on twitter" href="https://twitter.com/intent/tweet/?text=The%20Network%20Layer&url=https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f&hashtags=network"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share The Network Layer on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f&title=The%20Network%20Layer&summary=The%20Network%20Layer&source=https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share The Network Layer on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f&title=The%20Network%20Layer"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share The Network Layer on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share The Network Layer on whatsapp" href="https://api.whatsapp.com/send?text=The%20Network%20Layer%20-%20https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share The Network Layer on telegram" href="https://telegram.me/share/url?text=The%20Network%20Layer&url=https%3a%2f%2fraeperd.github.io%2fnotes%2fnetwork%2fthe-network-layer%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer><div id=disqus_thread></div>
<script>(function(){var a=document,b=a.createElement('script');b.src='https://raeperd-github-io.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
</article>
</main><footer class=footer>
<span>&copy; 2021 <a href=https://raeperd.github.io/>raeperd.github.io</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)">
<button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</button>
</a>
<script defer src=/assets/js/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>